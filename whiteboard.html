<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Valiant Vision Whiteboard</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f4f7;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    header {
      background: #4300b9;
      color: white;
      padding: 10px 20px;
      text-align: center;
      font-size: 1.2rem;
      font-weight: bold;
    }
    .toolbar {
      display: flex;
      align-items: center;
      gap: 10px;
      background: #fff;
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
    .toolbar button {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      background: #4300b9;
      color: white;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .toolbar button.active {
      background: #76b900;
    }
    #board {
      flex: 1;
      cursor: crosshair;
    }
    .sticky {
      position: absolute;
      background: yellow;
      padding: 10px;
      border: 1px solid #ccc;
      resize: both;
      overflow: auto;
      min-width: 120px;
      min-height: 80px;
      font-size: 14px;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <header>Valiant Vision Whiteboard</header>
  <div class="toolbar">
    <button id="pen" class="active">✏️ Pen</button>
    <button id="line">📏 Line</button>
    <button id="rect">⬛ Rectangle</button>
    <button id="circle">⚪ Circle</button>
    <button id="triangle">🔺 Triangle</button>
    <button id="arrow">➡️ Arrow</button>
    <button id="eraser">🩹 Eraser</button>
    <button id="sticky">📝 Sticky Note</button>
    <button id="clearSticky">🗑️ Clear All Notes</button>
    <input type="color" id="color" value="#000000">
    <input type="range" id="thickness" min="1" max="20" value="2">
  </div>
  <canvas id="board"></canvas>

  <script>
    const canvas = document.getElementById("board");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight - 100;

    let drawing = false;
    let tool = "pen";
    let startX, startY;

    const colorPicker = document.getElementById("color");
    const thickness = document.getElementById("thickness");

    document.querySelectorAll(".toolbar button").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".toolbar button").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        tool = btn.id;
      });
    });

    canvas.addEventListener("mousedown", e => {
      drawing = true;
      startX = e.offsetX;
      startY = e.offsetY;
      if(tool === "pen" || tool === "eraser") {
        ctx.beginPath();
        ctx.moveTo(startX, startY);
      }
    });

    canvas.addEventListener("mouseup", e => {
      if(!drawing) return;
      drawing = false;
      const endX = e.offsetX, endY = e.offsetY;
      ctx.strokeStyle = colorPicker.value;
      ctx.lineWidth = thickness.value;

      if(tool === "line") {
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(endX, endY);
        ctx.stroke();
      } 
      else if(tool === "rect") {
        ctx.strokeRect(startX, startY, endX - startX, endY - startY);
      } 
      else if(tool === "circle") {
        const radius = Math.sqrt((endX - startX)**2 + (endY - startY)**2);
        ctx.beginPath();
        ctx.arc(startX, startY, radius, 0, Math.PI*2);
        ctx.stroke();
      }
      else if(tool === "triangle") {
        ctx.beginPath();
        ctx.moveTo(startX, endY);
        ctx.lineTo((startX+endX)/2, startY);
        ctx.lineTo(endX, endY);
        ctx.closePath();
        ctx.stroke();
      }
      else if(tool === "arrow") {
        const headlen = 15;
        const angle = Math.atan2(endY - startY, endX - startX);
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(endX, endY);
        ctx.lineTo(endX - headlen * Math.cos(angle - Math.PI / 6),
                   endY - headlen * Math.sin(angle - Math.PI / 6));
        ctx.moveTo(endX, endY);
        ctx.lineTo(endX - headlen * Math.cos(angle + Math.PI / 6),
                   endY - headlen * Math.sin(angle + Math.PI / 6));
        ctx.stroke();
      }
    });

    canvas.addEventListener("mousemove", e => {
      if(!drawing) return;
      ctx.strokeStyle = (tool === "eraser") ? "#f4f4f7" : colorPicker.value;
      ctx.lineWidth = thickness.value;
      if(tool === "pen" || tool === "eraser") {
        ctx.lineTo(e.offsetX, e.offsetY);
        ctx.stroke();
      }
    });

    // === Sticky Notes (Draggable + Save in LocalStorage) ===
    function createSticky(content = "", x = 100, y = 100) {
      const note = document.createElement("textarea");
      note.className = "sticky";
      note.value = content;
      note.style.left = x + "px";
      note.style.top = y + "px";

      // Dragging
      note.onmousedown = function(e) {
        if (e.target.tagName !== "TEXTAREA") return;
        let offsetX = e.clientX - note.offsetLeft;
        let offsetY = e.clientY - note.offsetTop;

        function move(e) {
          note.style.left = (e.clientX - offsetX) + "px";
          note.style.top = (e.clientY - offsetY) + "px";
        }
        function stop() {
          document.removeEventListener("mousemove", move);
          document.removeEventListener("mouseup", stop);
          saveNotes();
        }
        document.addEventListener("mousemove", move);
        document.addEventListener("mouseup", stop);
      };

      // Save on change
      note.addEventListener("input", saveNotes);

      document.body.appendChild(note);
    }

    document.getElementById("sticky").addEventListener("click", () => {
      createSticky();
      saveNotes();
    });

    // Save sticky notes
    function saveNotes() {
      const notes = [];
      document.querySelectorAll(".sticky").forEach(n => {
        notes.push({
          content: n.value,
          x: n.offsetLeft,
          y: n.offsetTop,
          w: n.offsetWidth,
          h: n.offsetHeight
        });
      });
      localStorage.setItem("stickyNotes", JSON.stringify(notes));
    }
    

    // Load sticky notes
    function loadNotes() {
      const notes = JSON.parse(localStorage.getItem("stickyNotes") || "[]");
      notes.forEach(n => {
        createSticky(n.content, n.x, n.y);
        const added = document.querySelectorAll(".sticky");
        const last = added[added.length-1];
        last.style.width = n.w + "px";
        last.style.height = n.h + "px";
      });
    }

    window.onload = loadNotes;
  </script>
  <script>
  // Clear All Sticky Notes
  document.getElementById("clearSticky").addEventListener("click", () => {
    document.querySelectorAll(".sticky-wrap").forEach(note => note.remove());
    localStorage.removeItem("stickyNotes"); // clear saved notes too
  });
</script>

</body>
</html>


