<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Whiteboard</title>
<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Lora:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --vv-green:#00c853;
  --vv-dark:#1a1a1a;
  --vv-light:#f4f4f7;
  --vv-accent:#6200ea;
  --vv-red:#e53935;
  --vv-yellow:#ffeb3b;
  --vv-orange:#ff9800;
}

body {
  margin:0;
  font-family:'Lora', serif;
  background: var(--vv-light);
  display:flex;
  flex-direction:column;
  align-items:center;
}

#whiteboard-container{
  max-width:1400px;
  margin:20px auto;
  padding:0 20px;
  width:100%;
}

h2{
  text-align:center;
  color: var(--vv-dark);
  margin-bottom:15px;
}

#whiteboard-tools{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:10px;
  justify-content:center;
}

#whiteboard-tools button, 
#whiteboard-tools input[type=color], 
#whiteboard-tools input[type=number], 
#whiteboard-tools select{
  padding:8px 14px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  font-weight:600;
  background:var(--vv-green);
  color:white;
  transition:0.2s;
}
#whiteboard-tools button:hover{
  background:var(--vv-accent);
}

#whiteboard{
  border:2px solid var(--vv-dark);
  border-radius:12px;
  touch-action:none;
  width:100%;
  height:700px;
  background:#fff;
  display:block;
  position:relative;
}

/* Sticky Notes */
.sticky-note{
  position:absolute;
  background:#fffb8f;
  padding:10px;
  border:2px solid #f0e130;
  border-radius:8px;
  resize:both;
  overflow:auto;
  min-width:120px;
  min-height:60px;
  cursor:move;
  box-shadow:0 4px 6px rgba(0,0,0,0.1);
}
.note-header{
  cursor:move;
  font-weight:bold;
  margin-bottom:5px;
  display:flex;
  justify-content:space-between;
}
.note-header button{
  background:var(--vv-red);
  color:white;
  border:none;
  border-radius:4px;
  padding:0 5px;
  cursor:pointer;
}

/* Shape dropdown */
.dropdown{
  position:relative;
  display:inline-block;
}
.dropdown-content{
  display:none;
  position:absolute;
  background:#fff;
  min-width:140px;
  box-shadow:0 8px 16px rgba(0,0,0,0.2);
  border-radius:8px;
  z-index:1000;
}
.dropdown-content button{
  background:#00c853;
  color:white;
  padding:8px 12px;
  border:none;
  display:block;
  width:100%;
  text-align:left;
  margin:0;
  border-radius:0;
}
.dropdown-content button:hover{background:#6200ea;}
.dropdown:hover .dropdown-content{display:block;}
</style>
</head>
<body>

<div id="whiteboard-container">
  <h2>Whiteboard</h2>
  <div id="whiteboard-tools">
    <button onclick="setTool('pen')">Pen</button>
    <button onclick="setTool('eraser')">Eraser</button>

    <div class="dropdown">
      <button>Shapes â–¼</button>
      <div class="dropdown-content">
        <button onclick="setTool('line')">Line</button>
        <button onclick="setTool('dotted')">Dotted Line</button>
        <button onclick="setTool('rect')">Rectangle</button>
        <button onclick="setTool('circle')">Circle</button>
        <button onclick="setTool('ellipse')">Ellipse</button>
        <button onclick="setTool('triangle')">Triangle</button>
        <button onclick="setTool('star')">Star</button>
        <button onclick="setTool('arrow')">Arrow</button>
        <button onclick="setTool('polygon')">Polygon</button>
        <button onclick="setTool('curve')">Curve</button>
      </div>
    </div>

    <button onclick="setTool('text')">Text</button>
    <button onclick="addSticky()">Sticky Note</button>
    <button onclick="clearBoard()">Clear All</button>

    <label>Color: <input type="color" id="colorPicker" value="#000000"></label>
    <label>Width: <input type="number" id="widthPicker" value="3" min="1" max="50"></label>
    <label>Font Size: <input type="number" id="fontSize" value="20" min="10" max="72"></label>
    <label>Font:
      <select id="fontStyle"></select>
    </label>
    <label>
      <input type="checkbox" id="boldText"> Bold
      <input type="checkbox" id="italicText"> Italic
    </label>
  </div>

  <canvas id="whiteboard"></canvas>
</div>

<script>
// --- Fonts ---
const fonts=["Arial","Verdana","Times New Roman","Courier New","Georgia","Trebuchet MS","Impact","Comic Sans MS","Tahoma","Lucida Console","Palatino","Garamond","Bookman","Candara","Monaco","Futura","Century Gothic","Calibri","Optima","Franklin Gothic"];
const fontSelect=document.getElementById('fontStyle');
fonts.forEach(f=>{
  const opt=document.createElement('option');
  opt.value=f;
  opt.innerText=f;
  opt.style.fontFamily=f;
  fontSelect.appendChild(opt);
});

// --- Canvas Setup ---
const canvas=document.getElementById('whiteboard');
const ctx=canvas.getContext('2d');
let tempCanvas=document.createElement('canvas');
let tempCtx=tempCanvas.getContext('2d');
let drawing=false, startX=0, startY=0, tool='pen';
let color='#000', width=3, fontSize=20, fontStyle='Arial';
let objects=[]; // store all shapes/text for editing
let selectedObj=null;

function resizeCanvas(){
  canvas.width=canvas.offsetWidth;
  canvas.height=canvas.offsetHeight;
  tempCanvas.width=canvas.width;
  tempCanvas.height=canvas.height;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function setTool(t){ tool=t; selectedObj=null; }

function clearBoard(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  objects=[];
  document.querySelectorAll('.sticky-note').forEach(n=>n.remove());
}

// --- Position ---
function getPos(e){
  const rect=canvas.getBoundingClientRect();
  let x,y;
  if(e.touches){ x=e.touches[0].clientX-rect.left; y=e.touches[0].clientY-rect.top; }
  else{ x=e.clientX-rect.left; y=e.clientY-rect.top; }
  return {x,y};
}

// --- Sticky Notes ---
const stickyColors=["#fffb8f","#ffcccc","#ccffcc","#cce0ff","#ffccff","#ffe0b3"];
function addSticky(){
  const note=document.createElement('div');
  note.classList.add('sticky-note');
  note.style.top='100px';
  note.style.left='100px';
  note.style.background=stickyColors[Math.floor(Math.random()*stickyColors.length)];
  note.innerHTML=`<div class="note-header">Note <button onclick="this.parentElement.parentElement.remove()">X</button></div><div contenteditable style="min-height:50px;"></div>`;
  document.body.appendChild(note);
  dragElement(note);
}
function dragElement(elmnt){
  let pos1=0,pos2=0,pos3=0,pos4=0;
  const header=elmnt.querySelector('.note-header');
  if(header){ header.onmousedown=dragMouseDown; } else { elmnt.onmousedown=dragMouseDown; }
  function dragMouseDown(e){
    e.preventDefault();
    pos3=e.clientX;
    pos4=e.clientY;
    document.onmouseup=closeDragElement;
    document.onmousemove=elementDrag;
  }
  function elementDrag(e){
    e.preventDefault();
    pos1=pos3-e.clientX; pos2=pos4-e.clientY;
    pos3=e.clientX; pos4=e.clientY;
    elmnt.style.top=(elmnt.offsetTop-pos2)+'px';
    elmnt.style.left=(elmnt.offsetLeft-pos1)+'px';
  }
  function closeDragElement(){ document.onmouseup=null; document.onmousemove=null; }
}

// --- Drawing ---
canvas.addEventListener('mousedown',startDraw);
canvas.addEventListener('mousemove',draw);
canvas.addEventListener('mouseup',endDraw);
canvas.addEventListener('mouseout',endDraw);
canvas.addEventListener('touchstart',startDraw);
canvas.addEventListener('touchmove',draw);
canvas.addEventListener('touchend',endDraw);

function startDraw(e){
  drawing=true;
  const pos=getPos(e);
  startX=pos.x; startY=pos.y;
  color=document.getElementById('colorPicker').value;
  width=parseInt(document.getElementById('widthPicker').value);
  fontSize=parseInt(document.getElementById('fontSize').value);
  fontStyle=document.getElementById('fontStyle').value;
}

function draw(e){
  if(!drawing) return;
  const pos=getPos(e);
  tempCtx.clearRect(0,0,tempCanvas.width,tempCanvas.height);
  tempCtx.drawImage(canvas,0,0);
  tempCtx.strokeStyle=color; tempCtx.fillStyle=color; tempCtx.lineWidth=width;
  if(tool==='dotted'){ tempCtx.setLineDash([5,5]); } else { tempCtx.setLineDash([]); }

  const w=pos.x-startX, h=pos.y-startY;

  switch(tool){
    case 'line': tempCtx.beginPath(); tempCtx.moveTo(startX,startY); tempCtx.lineTo(pos.x,pos.y); tempCtx.stroke(); break;
    case 'dotted': tempCtx.beginPath(); tempCtx.moveTo(startX,startY); tempCtx.lineTo(pos.x,pos.y); tempCtx.stroke(); break;
    case 'rect': tempCtx.strokeRect(startX,startY,w,h); break;
    case 'circle': tempCtx.beginPath(); tempCtx.arc(startX,startY,Math.sqrt(w*w+h*h),0,2*Math.PI); tempCtx.stroke(); break;
    case 'ellipse': tempCtx.beginPath(); tempCtx.ellipse(startX,startY,Math.abs(w),Math.abs(h),0,0,2*Math.PI); tempCtx.stroke(); break;
    case 'triangle': tempCtx.beginPath(); tempCtx.moveTo(startX,startY); tempCtx.lineTo(startX+w,startY+h); tempCtx.lineTo(startX-w,startY+h); tempCtx.closePath(); tempCtx.stroke(); break;
    case 'star': drawStar(tempCtx,startX,startY,5,Math.sqrt(w*w+h*h)/2,Math.sqrt(w*w+h*h)/4); break;
    case 'arrow': drawArrow(tempCtx,startX,startY,pos.x,pos.y); break;
    case 'polygon': drawPolygon(tempCtx,startX,startY,6,Math.sqrt(w*w+h*h)); break;
    case 'curve': tempCtx.beginPath(); tempCtx.moveTo(startX,startY); tempCtx.quadraticCurveTo(startX+(w/2),startY-h,pos.x,pos.y); tempCtx.stroke(); break;
    case 'text': tempCtx.font=`${fontSize}px ${fontStyle}`; if(document.getElementById('boldText').checked) tempCtx.font='bold '+tempCtx.font; if(document.getElementById('italicText').checked) tempCtx.font='italic '+tempCtx.font; tempCtx.fillText("Sample Text",pos.x,pos.y); break;
    case 'pen': tempCtx.beginPath(); tempCtx.moveTo(startX,startY); tempCtx.lineTo(pos.x,pos.y); tempCtx.stroke(); break;
    case 'eraser': tempCtx.beginPath(); tempCtx.strokeStyle='#fff'; tempCtx.lineWidth=width*2; tempCtx.moveTo(startX,startY); tempCtx.lineTo(pos.x,pos.y); tempCtx.stroke(); break;
  }
}

function endDraw(e){
  if(!drawing) return;
  drawing=false;
  const pos=getPos(e);
  if(tool==='text'){
    let obj={type:'text', x:pos.x, y:pos.y, text:'', font:fontStyle, size:fontSize, color:color, bold:document.getElementById('boldText').checked, italic:document.getElementById('italicText').checked};
    objects.push(obj);
    createTextInput(obj);
  } else {
    ctx.drawImage(tempCanvas,0,0);
    tempCtx.clearRect(0,0,tempCanvas.width,tempCanvas.height);
  }
}

// --- Text Input Overlay ---
function createTextInput(obj){
  const input=document.createElement('input');
  input.type='text';
  input.style.position='absolute';
  input.style.left=obj.x+'px';
  input.style.top=obj.y+'px';
  input.style.fontFamily=obj.font;
  input.style.fontSize=obj.size+'px';
  input.style.color=obj.color;
  if(obj.bold) input.style.fontWeight='bold';
  if(obj.italic) input.style.fontStyle='italic';
  document.body.appendChild(input);
  input.focus();
  input.onblur=function(){
    obj.text=input.value;
    document.body.removeChild(input);
    drawObjects();
  }
}

// --- Draw all objects ---
function drawObjects(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  objects.forEach(o=>{
    if(o.type==='text'){
      ctx.font=`${o.size}px ${o.font}`;
      if(o.bold) ctx.font='bold '+ctx.font;
      if(o.italic) ctx.font='italic '+ctx.font;
      ctx.fillStyle=o.color;
      ctx.fillText(o.text,o.x,o.y);
    }
    // Future: handle shapes, sticky notes in objects
  });
}

// --- Shape helpers ---
function drawStar(c,x,y,points,outer,rInner){ const angle=Math.PI/points; c.beginPath(); for(let i=0;i<2*points;i++){ const r=i%2===0?outer:rInner; const a=i*angle-Math.PI/2; c.lineTo(x+r*Math.cos(a),y+r*Math.sin(a)); } c.closePath(); c.stroke(); }
function drawArrow(c,x1,y1,x2,y2){ const headLength=15; const dx=x2-x1, dy=y2-y1, angle=Math.atan2(dy,dx); c.beginPath(); c.moveTo(x1,y1); c.lineTo(x2,y2); c.lineTo(x2-headLength*Math.cos(angle-Math.PI/6),y2-headLength*Math.sin(angle-Math.PI/6)); c.moveTo(x2,y2); c.lineTo(x2-headLength*Math.cos(angle+Math.PI/6),y2-headLength*Math.sin(angle+Math.PI/6)); c.stroke(); }
function drawPolygon(c,x,y,sides,r){ c.beginPath(); for(let i=0;i<sides;i++){ const a=(2*Math.PI*i/sides)-Math.PI/2; const px=x+r*Math.cos(a), py=y+r*Math.sin(a); if(i===0) c.moveTo(px,py); else c.lineTo(px,py); } c.closePath(); c.stroke(); }
</script>

</body>
</html>
