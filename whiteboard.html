<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Full Whiteboard</title>
<style>
  html,body{margin:0;height:100%;background:#f8fafc;font-family:sans-serif;}
  #board{position:fixed;inset:0;background:#fff;touch-action:none;}
  .toolbar{
    position:fixed;top:10px;left:50%;transform:translateX(-50%);
    background:#fff;padding:8px 10px;border-radius:12px;
    box-shadow:0 4px 10px rgba(0,0,0,0.15);z-index:2000;
    display:flex;gap:8px;flex-wrap:wrap;
  }
  button,select,input{border:0;padding:6px 10px;border-radius:8px;cursor:pointer;}
  select{background:#eef2ff;font-weight:600;}
  .note{position:absolute;background:#fff59d;border:1px solid #555;
        border-radius:8px;min-width:120px;min-height:80px;z-index:1500;
        box-shadow:0 3px 8px rgba(0,0,0,0.2);display:flex;flex-direction:column;}
  .note .hdr{background:rgba(0,0,0,0.1);padding:4px;cursor:grab;font-weight:bold;}
  .note textarea{flex:1;border:0;padding:6px;resize:none;background:transparent;}
</style>
</head>
<body>
<canvas id="board"></canvas>

<div class="toolbar">
  <select id="tool">
    <option value="pen">‚úè Pen</option>
    <option value="eraser">ü©π Eraser</option>
    <option value="select">üî≤ Select</option>
  </select>

  <select id="shapeTool">
    <option value="">Shapes ‚ñº</option>
    <option value="line">Line</option>
    <option value="rect">Rectangle</option>
    <option value="circle">Circle</option>
    <option value="ellipse">Ellipse</option>
    <option value="triangle">Triangle</option>
    <option value="star">Star</option>
    <option value="arrow">Arrow</option>
    <option value="polygon">Polygon (6)</option>
  </select>

  <input type="color" id="color" value="#000000"/>
  <input type="range" id="size" min="1" max="30" value="3"/>
  <button onclick="addNote()">üìù Note</button>
  <button onclick="deleteSelected()">‚ùå Delete</button>
  <button onclick="clearBoard()">üßπ Clear</button>
</div>

<script>
const canvas=document.getElementById("board"),ctx=canvas.getContext("2d");
function resize(){canvas.width=innerWidth;canvas.height=innerHeight;redraw();}
window.onresize=resize;resize();

let tool="pen",shapeType="",color="#000",size=3,shapes=[],drawing=false,temp=null,startX=0,startY=0;
document.getElementById("tool").onchange=e=>{tool=e.target.value;shapeType="";};
document.getElementById("shapeTool").onchange=e=>{shapeType=e.target.value;tool=shapeType? "shape":tool;};
document.getElementById("color").oninput=e=>color=e.target.value;
document.getElementById("size").oninput=e=>size=+e.target.value;

canvas.addEventListener("pointerdown",e=>{
  const p=getPos(e);startX=p.x;startY=p.y;drawing=true;
  if(tool==="pen"){temp={type:"pen",color,size,points:[[p.x,p.y]]};shapes.push(temp);}
  if(tool==="eraser"){erase(p);}
  if(tool==="shape"&&shapeType){temp={type:shapeType,color,size,x1:p.x,y1:p.y,x2:p.x,y2:p.y};}
});
canvas.addEventListener("pointermove",e=>{
  if(!drawing)return;const p=getPos(e);
  if(tool==="pen"){temp.points.push([p.x,p.y]);redraw();}
  if(tool==="eraser"){erase(p);}
  if(tool==="shape"&&temp){temp.x2=p.x;temp.y2=p.y;redraw();drawPreview(temp);}
});
canvas.addEventListener("pointerup",e=>{
  if(!drawing)return;drawing=false;
  if(tool==="shape"&&temp){shapes.push({...temp});temp=null;redraw();}
});

function getPos(e){const r=canvas.getBoundingClientRect();return {x:e.clientX-r.left,y:e.clientY-r.top};}
function erase(p){ctx.clearRect(p.x-size,p.y-size,size*2,size*2);}
function redraw(){ctx.clearRect(0,0,canvas.width,canvas.height);for(const s of shapes)drawShape(s);}
function drawShape(s){
  ctx.strokeStyle=s.color;ctx.lineWidth=s.size;ctx.beginPath();
  if(s.type==="pen"){ctx.moveTo(s.points[0][0],s.points[0][1]);for(const pt of s.points)ctx.lineTo(pt[0],pt[1]);ctx.stroke();}
  if(s.type==="line"){ctx.moveTo(s.x1,s.y1);ctx.lineTo(s.x2,s.y2);ctx.stroke();}
  if(s.type==="rect"){ctx.strokeRect(s.x1,s.y1,s.x2-s.x1,s.y2-s.y1);}
  if(s.type==="circle"){let r=Math.hypot(s.x2-s.x1,s.y2-s.y1);ctx.arc(s.x1,s.y1,r,0,2*Math.PI);ctx.stroke();}
  if(s.type==="ellipse"){ctx.ellipse((s.x1+s.x2)/2,(s.y1+s.y2)/2,Math.abs(s.x2-s.x1)/2,Math.abs(s.y2-s.y1)/2,0,0,2*Math.PI);ctx.stroke();}
  if(s.type==="triangle"){ctx.moveTo(s.x1,s.y2);ctx.lineTo((s.x1+s.x2)/2,s.y1);ctx.lineTo(s.x2,s.y2);ctx.closePath();ctx.stroke();}
  if(s.type==="star"){drawStar(s.x1,s.y1,s.x2,s.y2);} 
  if(s.type==="arrow"){drawArrow(s.x1,s.y1,s.x2,s.y2);}
  if(s.type==="polygon"){drawPolygon(s.x1,s.y1,s.x2,s.y2,6);}
}
function drawPreview(s){ctx.save();ctx.setLineDash([6,6]);drawShape(s);ctx.restore();}
function drawStar(x1,y1,x2,y2){
  const cx=(x1+x2)/2,cy=(y1+y2)/2,r=Math.hypot(x2-x1,y2-y1)/2,sp=5;
  ctx.moveTo(cx,cy-r);
  for(let i=1;i<=sp*2;i++){const ang=i*Math.PI/sp;const rr=i%2?r/2:r;ctx.lineTo(cx+rr*Math.sin(ang),cy-rr*Math.cos(ang));}
  ctx.closePath();ctx.stroke();
}
function drawArrow(x1,y1,x2,y2){
  ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();
  const ang=Math.atan2(y2-y1,x2-x1),len=10;
  ctx.beginPath();ctx.moveTo(x2,y2);
  ctx.lineTo(x2-len*Math.cos(ang-Math.PI/6),y2-len*Math.sin(ang-Math.PI/6));
  ctx.lineTo(x2-len*Math.cos(ang+Math.PI/6),y2-len*Math.sin(ang+Math.PI/6));
  ctx.closePath();ctx.fillStyle=color;ctx.fill();
}
function drawPolygon(x1,y1,x2,y2,n){
  const cx=(x1+x2)/2,cy=(y1+y2)/2,r=Math.hypot(x2-x1,y2-y1)/2;
  ctx.moveTo(cx+r,cy);
  for(let i=1;i<=n;i++){const ang=i*2*Math.PI/n;ctx.lineTo(cx+r*Math.cos(ang),cy+r*Math.sin(ang));}
  ctx.closePath();ctx.stroke();
}

function addNote(){
  const n=document.createElement("div");n.className="note";n.style.left="100px";n.style.top="100px";
  n.innerHTML=`<div class="hdr">Note</div><textarea></textarea>`;
  document.body.appendChild(n);
  const hdr=n.querySelector(".hdr");hdr.onpointerdown=e=>{
    const sx=e.clientX,sy=e.clientY,l=parseInt(n.style.left),t=parseInt(n.style.top);
    function mv(ev){n.style.left=(l+ev.clientX-sx)+"px";n.style.top=(t+ev.clientY-sy)+"px";}
    function up(){window.removeEventListener("pointermove",mv);}
    window.addEventListener("pointermove",mv);window.addEventListener("pointerup",up,{once:true});
  };
}

function deleteSelected(){shapes.pop();redraw();}
function clearBoard(){shapes=[];ctx.clearRect(0,0,canvas.width,canvas.height);document.querySelectorAll(".note").forEach(n=>n.remove());}
</script>
</body>
</html>
